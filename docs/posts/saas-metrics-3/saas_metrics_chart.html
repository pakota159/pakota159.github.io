<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SaaS Metrics Framework</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; background-color: #f8fafc; } 
        #unified-metrics-root { padding: 0.5rem; }
        /* Custom scrollbar for inputs */
        /* 1. Chrome, Safari, Edge, Opera */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
          -webkit-appearance: none;
          margin: 0;
        }
        /* 2. Firefox */
        input[type=number] {
          -moz-appearance: textfield;
        }
    </style>
</head>
<body>

    <div id="unified-metrics-root"></div>

    <script type="text/babel">
      const { useState, useEffect, useMemo } = React;

      // --- HELPER: Input Field Component ---
      const CalculatorInput = ({ label, value, onChange, unit = "", placeholder = "0" }) => (
        <div className="flex flex-col">
            <label className="text-[10px] uppercase font-bold text-slate-500 mb-1">{label}</label>
            <div className="relative">
                <input 
                    type="number" 
                    value={value} 
                    onChange={(e) => onChange(parseFloat(e.target.value) || 0)}
                    className="w-full border border-slate-300 rounded-md px-3 py-1.5 text-sm focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors bg-white text-slate-700 font-mono"
                    placeholder={placeholder}
                />
                {unit && <span className="absolute right-3 top-1.5 text-xs text-slate-400 font-medium">{unit}</span>}
            </div>
        </div>
      );

      // --- HELPER: Result Badge Component ---
      const ResultBadge = ({ label, value, unit, status, insight }) => {
        const colors = {
            good: "bg-green-100 text-green-800 border-green-200",
            warning: "bg-yellow-50 text-yellow-800 border-yellow-200",
            bad: "bg-red-50 text-red-800 border-red-200",
            neutral: "bg-slate-100 text-slate-600 border-slate-200"
        };
        const statusColor = colors[status] || colors.neutral;

        return (
            <div className={`p-3 rounded-lg border ${statusColor} flex flex-col justify-between h-full`}>
                <div>
                    <div className="text-[10px] uppercase tracking-wider opacity-70 font-bold mb-1">{label}</div>
                    <div className="text-xl font-bold font-mono">
                        {value === Infinity || isNaN(value) ? "--" : value} <span className="text-sm font-normal opacity-80">{unit}</span>
                    </div>
                </div>
                {insight && <div className="mt-2 text-xs border-t border-black/10 pt-2 italic leading-tight">{insight}</div>}
            </div>
        );
      };

      const UnifiedMetricsFramework = () => {
        // CHANGED: Default active layer is now 2 (Business Model)
        const [activeLayer, setActiveLayer] = useState(2);
        
        // Selection States
        const [selectedGTM, setSelectedGTM] = useState(null);
        const [selectedGrowth, setSelectedGrowth] = useState(null);
        const [selectedPricing, setSelectedPricing] = useState(null);
        const [selectedMarket, setSelectedMarket] = useState(null);
        
        const [productView, setProductView] = useState('frameworks'); 
        const [activePlatform, setActivePlatform] = useState('ga4');
        const [isCalculatorMode, setIsCalculatorMode] = useState(false);

        // --- CALCULATOR STATE ---
        const [inputs, setInputs] = useState({
            revenue: 100000,
            cogs: 25000,
            marketingSpend: 30000,
            newCustomers: 50,
            totalCustomers: 500,
            churnedCustomers: 15,
            growthRate: 35,
            fcfMargin: 10
        });

        // --- CALCULATIONS LOGIC ---
        const metrics = useMemo(() => {
            const gm = inputs.revenue > 0 ? ((inputs.revenue - inputs.cogs) / inputs.revenue) * 100 : 0;
            const cac = inputs.newCustomers > 0 ? inputs.marketingSpend / inputs.newCustomers : 0;
            const arpu = inputs.totalCustomers > 0 ? (inputs.revenue / 12) / inputs.totalCustomers : 0; 
            const churnRate = inputs.totalCustomers > 0 ? (inputs.churnedCustomers / inputs.totalCustomers) * 100 : 0;
            
            const ltv = churnRate > 0 ? (arpu * (gm / 100)) / (churnRate / 100) : 0;
            const ltvCac = cac > 0 ? ltv / cac : 0;
            const payback = (arpu * (gm/100)) > 0 ? cac / (arpu * (gm/100)) : 0;
            const rule40 = inputs.growthRate + inputs.fcfMargin;

            return { gm, cac, ltv, ltvCac, payback, rule40, churnRate, arpu };
        }, [inputs]);

        // --- BENCHMARK JUDGMENT ---
        const getInsight = (type, val) => {
            if (type === 'gm') {
                if (val >= 70) return { status: 'good', text: "Excellent! Pure SaaS model." };
                if (val >= 50) return { status: 'warning', text: "Average. Watch your server/support costs." };
                return { status: 'bad', text: "Low. Likely a service business or heavy COGS." };
            }
            if (type === 'ltvCac') {
                if (val >= 3) return { status: 'good', text: "Healthy growth engine." };
                if (val >= 1) return { status: 'warning', text: "Inefficient. Verify pricing or reduce CAC." };
                return { status: 'bad', text: "Burning money. You lose $ on every sale." };
            }
            if (type === 'payback') {
                if (val <= 12) return { status: 'good', text: "Great cash flow cycle." };
                if (val <= 18) return { status: 'warning', text: "Acceptable for Enterprise, risky for SMB." };
                return { status: 'bad', text: "Dangerous. Takes too long to recover cost." };
            }
            if (type === 'rule40') {
                if (val >= 40) return { status: 'good', text: "Investor favorite (Healthy)." };
                return { status: 'warning', text: "Below standard. Balance growth vs profit." };
            }
            return { status: 'neutral', text: "" };
        };

        // --- AUTO-RESIZE LOGIC ---
        useEffect(() => {
            const sendHeight = () => {
                const root = document.getElementById('unified-metrics-root');
                if (root) {
                    const height = root.scrollHeight + 20; 
                    window.parent.postMessage({ frameHeight: height }, '*');
                }
            };
            sendHeight();
            const observer = new ResizeObserver(sendHeight);
            const rootElement = document.getElementById('unified-metrics-root');
            if (rootElement) observer.observe(rootElement);
            return () => observer.disconnect();
        }, [activeLayer, isCalculatorMode, selectedGTM, selectedGrowth, selectedPricing, selectedMarket]); 
        
        // --- FIXED DATA: URLs ---
        const layerReferences = {
          1: [
            { title: "SaaS Metrics 2.0", source: "David Skok", url: "https://www.forentrepreneurs.com/saas-metrics-2/" },
            { title: "The Rule of 40", source: "Brad Feld", url: "https://feld.com/archives/2015/02/rule-40-healthy-saas-company.html" },
            { title: "KeyBanc SaaS Survey", source: "KeyBanc", url: "https://www.key.com/businesses-institutions/industry-expertise/technology-group/saas-survey.html" }
          ],
          2: [
            { title: "The PLG Index", source: "OpenView", url: "https://openviewpartners.com/plg/" },
            { title: "SaaS Pricing Guide", source: "Stripe", url: "https://stripe.com/guides/saas-pricing-models" },
            { title: "Marketplace Metrics", source: "a16z", url: "https://a16z.com/marketplace-metrics/" },
            { title: "Vertical SaaS Laws", source: "Bessemer", url: "https://www.bvp.com/atlas/ten-laws-of-vertical-saas" }
          ],
          3: [
            { title: "HEART Framework", source: "Google", url: "https://library.gv.com/google-heart-framework-b068897040ce" },
            { title: "AARRR Metrics", source: "Dave McClure", url: "https://500hats.com/startup-metrics-for-pirates-aarrr/" },
            { title: "North Star", source: "Amplitude", url: "https://amplitude.com/north-star" }
          ],
          4: [
            { title: "Sales Metrics", source: "HubSpot", url: "https://blog.hubspot.com/sales/sales-metrics" },
            { title: "Burn Multiple", source: "David Sacks", url: "https://sacks.substack.com/p/the-burn-multiple" }
          ]
        };

        // --- DATA: LAYER 2 OPTIONS ---
        const gtmOptions = [
          { id: 'self-service', label: 'Self-Service (PLG)' },
          { id: 'transactional', label: 'Transactional' },
          { id: 'enterprise', label: 'Enterprise' }
        ];
        const growthOptions = [
          { id: 'plg', label: 'Product-Led' },
          { id: 'slg', label: 'Sales-Led' },
          { id: 'hybrid', label: 'Hybrid' }
        ];
        const pricingOptions = [
          { id: 'seat', label: 'Per-User / Seat' },
          { id: 'tiered', label: 'Tiered Package' },
          { id: 'usage', label: 'Usage-Based' },
          { id: 'transactional', label: 'Transactional' },
          { id: 'freemium', label: 'Freemium' }
        ];
        const marketOptions = [
          { id: 'horizontal', label: 'Horizontal SaaS' },
          { id: 'vertical', label: 'Vertical SaaS' }
        ];

        // --- DATA: LAYER 2 METRICS LOGIC ---
        const getLayer2Metrics = () => {
          const metrics = [];
          
          // 1. GTM METRICS
          if (selectedGTM === 'self-service') {
            metrics.push({ name: 'Visitor-to-Signup', desc: 'Target: 2% - 5%', cat: 'GTM' });
            metrics.push({ name: 'PQL (Product Qualified Lead)', desc: 'User hit "Aha!" moment', cat: 'GTM' });
            metrics.push({ name: 'Trial-to-Paid Rate', desc: 'Target: > 15%', cat: 'GTM' });
          } else if (selectedGTM === 'transactional') {
            metrics.push({ name: 'MQL to SQL Rate', desc: 'Target: 10% - 20%', cat: 'GTM' });
            metrics.push({ name: 'Win Rate', desc: 'Target: 20% - 30%', cat: 'GTM' });
            metrics.push({ name: 'Sales Cycle', desc: '30 - 90 days', cat: 'GTM' });
          } else if (selectedGTM === 'enterprise') {
            metrics.push({ name: 'Pipeline Coverage', desc: 'Target: 3x - 4x Quota', cat: 'GTM' });
            metrics.push({ name: 'TCV (Total Contract Value)', desc: 'Multi-year value', cat: 'GTM' });
            metrics.push({ name: 'RFP Win Rate', desc: 'Bid success rate', cat: 'GTM' });
          }

          // 2. GROWTH METRICS
          if (selectedGrowth === 'plg') {
            metrics.push({ name: 'Viral Coefficient (K)', desc: 'Target: > 1.0', cat: 'Growth' });
            metrics.push({ name: 'Activation Rate', desc: 'Core action completion', cat: 'Growth' });
          } else if (selectedGrowth === 'slg') {
            metrics.push({ name: 'Magic Number', desc: 'Target: > 0.75', cat: 'Growth' });
            metrics.push({ name: 'Quota Attainment', desc: 'Target: > 80% reps', cat: 'Growth' });
            metrics.push({ name: 'Sales Ramp Time', desc: 'Time to full productivity', cat: 'Growth' });
          } else if (selectedGrowth === 'hybrid') {
            metrics.push({ name: 'PQL to SQL Rate', desc: 'Handoff efficiency', cat: 'Growth' });
            metrics.push({ name: 'Product-Influenced Pipeline', desc: 'Target: > 30%', cat: 'Growth' });
          }

          // 3. PRICING METRICS
          if (selectedPricing === 'seat') {
            metrics.push({ name: 'License Utilization', desc: 'Active Seats / Paid Seats (>85%)', cat: 'Pricing' });
            metrics.push({ name: 'Seat Expansion Rate', desc: 'Upsell via new users', cat: 'Pricing' });
          } else if (selectedPricing === 'tiered') {
            metrics.push({ name: 'Upgrade Rate', desc: 'Basic -> Pro (10-20%)', cat: 'Pricing' });
            metrics.push({ name: 'Feature Adoption Gap', desc: 'Usage of premium features', cat: 'Pricing' });
          } else if (selectedPricing === 'usage') {
            metrics.push({ name: 'Consumption Rate', desc: 'Usage burn rate', cat: 'Pricing' });
            metrics.push({ name: 'Overage Revenue', desc: 'Revenue > Commitment', cat: 'Pricing' });
            metrics.push({ name: 'RPO', desc: 'Remaining Obligations', cat: 'Pricing' });
          } else if (selectedPricing === 'transactional') {
            metrics.push({ name: 'GMV', desc: 'Gross Merchandise Value', cat: 'Pricing' });
            metrics.push({ name: 'Take Rate', desc: '% Revenue / GMV', cat: 'Pricing' });
          } else if (selectedPricing === 'freemium') {
            metrics.push({ name: 'Free-to-Paid Rate', desc: 'Target: 2% - 5%', cat: 'Pricing' });
            metrics.push({ name: 'Cost to Serve (Free)', desc: 'Support/Server cost per free user', cat: 'Pricing' });
          }

          // 4. MARKET FOCUS METRICS
          if (selectedMarket === 'horizontal') {
            metrics.push({ name: 'Geo Expansion Rate', desc: 'New countries entered', cat: 'Market' });
            metrics.push({ name: 'Integration Breadth', desc: '# of 3rd party apps', cat: 'Market' });
          } else if (selectedMarket === 'vertical') {
            metrics.push({ name: 'Market Penetration %', desc: 'Total customers / TAM', cat: 'Market' });
            metrics.push({ name: 'Product Attach Rate', desc: 'Multi-product adoption', cat: 'Market' });
            metrics.push({ name: 'ARPA Growth', desc: 'Target: 30-50% via cross-sell', cat: 'Market' });
            metrics.push({ name: 'Fintech Take Rate', desc: 'Payment processing fees', cat: 'Market' });
          }

          return metrics;
        };

        const layer2Metrics = getLayer2Metrics();
        const catColors = { GTM: 'bg-blue-100 text-blue-800', Growth: 'bg-green-100 text-green-800', Pricing: 'bg-purple-100 text-purple-800', Market: 'bg-orange-100 text-orange-800' };

        // --- DATA: LAYER 3 PRODUCT & LAYER 4 OPERATIONAL (Placeholder for brevity) ---
        // (You can paste the full objects here from previous versions if needed for full functionality)
        const productFrameworks = { heart: { name: 'HEART', dims: [] } }; 
        const platformFrameworks = { ga4: { name: 'GA4', color: 'bg-orange-500', approach: 'Event-Based', desc: '', categories: [] } };
        const currentPlatform = platformFrameworks[activePlatform] || {categories: []};
        const operationalMetrics = {};

        // --- COMPONENT HELPERS ---
        const SelectionGroup = ({ title, options, selected, onSelect }) => (
          <div className="mb-2">
            <div className="text-xs font-semibold text-gray-600 mb-1">{title}</div>
            <div className="flex flex-wrap gap-1">
              {options.map(o => (
                <button key={o.id} onClick={() => onSelect(selected === o.id ? null : o.id)}
                  className={`px-2 py-0.5 rounded-full text-xs transition-all ${selected === o.id ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`}>
                  {o.label}
                </button>
              ))}
            </div>
          </div>
        );

        const LayerTab = ({ num, title, active, onClick, color }) => (
          <button onClick={onClick}
            className={`flex-1 p-2 text-center rounded-lg transition-all border-b-4 hover:bg-gray-50 ${active ? `${color} border-current bg-white shadow-sm` : 'border-transparent text-gray-500'}`}>
            <div className="text-xs uppercase tracking-wider opacity-60">Layer {num}</div>
            <div className="font-bold text-sm">{title}</div>
          </button>
        );

        return (
          <div className="bg-slate-50 p-4 rounded-xl font-sans text-left border border-slate-200" style={{minHeight: '600px'}}>
            <div className="max-w-5xl mx-auto">
              <h1 className="text-2xl font-bold text-gray-900 mb-1 text-center">4-Layer SaaS Metrics Framework</h1>
              <p className="text-gray-500 text-sm mb-6 text-center">From Financial Fundamentals to Deep Product Analysis</p>
              
              {/* TOP NAVIGATION */}
              <div className="flex gap-2 mb-4 bg-slate-200 p-1 rounded-xl">
                <LayerTab num={1} title="Universal" active={activeLayer === 1} onClick={() => setActiveLayer(1)} color="text-red-600 border-red-500" />
                <LayerTab num={2} title="Business Model" active={activeLayer === 2} onClick={() => setActiveLayer(2)} color="text-blue-600 border-blue-500" />
                <LayerTab num={3} title="Product Analysis" active={activeLayer === 3} onClick={() => setActiveLayer(3)} color="text-purple-600 border-purple-500" />
                <LayerTab num={4} title="Operational" active={activeLayer === 4} onClick={() => setActiveLayer(4)} color="text-amber-600 border-amber-500" />
              </div>

              {/* LAYER 1: UNIVERSAL */}
              {activeLayer === 1 && (
                <div className="bg-white rounded-xl shadow-sm border border-slate-100 p-5 animate-fade-in">
                  <div className="flex items-center justify-between mb-4 border-b border-gray-100 pb-3">
                    <div className="flex items-center gap-2">
                        <span className="p-1.5 bg-red-100 text-red-600 rounded text-lg">üí∞</span>
                        <div>
                        <h2 className="font-bold text-gray-800">Financial Metrics</h2>
                        <p className="text-xs text-gray-500">C√°c ch·ªâ s·ªë t√†i ch√≠nh c√¥ng ty n√†o c≈©ng n√™n follow</p>
                        </div>
                    </div>
                    <div className="flex items-center bg-gray-100 p-1 rounded-lg">
                        <button onClick={() => setIsCalculatorMode(false)} className={`px-3 py-1 text-xs font-bold rounded-md transition-all ${!isCalculatorMode ? 'bg-white shadow text-red-600' : 'text-gray-500 hover:text-gray-700'}`}>üìñ Concept</button>
                        <button onClick={() => setIsCalculatorMode(true)} className={`px-3 py-1 text-xs font-bold rounded-md transition-all ${isCalculatorMode ? 'bg-white shadow text-red-600' : 'text-gray-500 hover:text-gray-700'}`}>üßÆ Calculator</button>
                    </div>
                  </div>
                  {!isCalculatorMode ? (
                      <div className="space-y-2">
                        {[
                          { name: 'ARR/MRR', formula: 'Sum of recurring revenue' },
                          { name: 'Gross Margin', formula: '(Rev - COGS) / Rev | Target: >70%' },
                          { name: 'LTV:CAC Ratio', formula: 'LTV / CAC | Target: >3x' },
                          { name: 'CAC Payback', formula: 'CAC / (MRR * GM%) | <12mo' },
                          { name: 'Net Revenue Retention', formula: '(Start + Exp - Churn) / Start | >100%' },
                          { name: 'Gross Revenue Retention', formula: '(Start - Churn) / Start | >85%' },
                          { name: 'Rule of 40', formula: 'Growth% + FCF% | >40%' }
                        ].map((m, i) => (
                          <div key={i} className="flex items-center justify-between bg-red-50 rounded-lg px-4 py-3 hover:bg-red-100 transition-colors">
                            <span className="font-medium text-gray-900">{m.name}</span>
                            <span className="text-xs text-red-700 font-mono bg-white px-2 py-1 rounded border border-red-100">{m.formula}</span>
                          </div>
                        ))}
                         <div className="mt-4 text-xs text-gray-500 text-center italic">üí° Switch to "Calculator" mode to calculate your own metrics.</div>
                      </div>
                  ) : (
                      <div className="grid grid-cols-1 md:grid-cols-12 gap-6">
                          <div className="md:col-span-4 space-y-4 bg-slate-50 p-4 rounded-lg border border-slate-200">
                              <h3 className="font-bold text-gray-700 text-sm border-b border-gray-200 pb-2 mb-2">1. Input Data</h3>
                              <CalculatorInput label="Annual Revenue" value={inputs.revenue} onChange={(v)=>setInputs({...inputs, revenue: v})} unit="$" />
                              <CalculatorInput label="COGS" value={inputs.cogs} onChange={(v)=>setInputs({...inputs, cogs: v})} unit="$" />
                              <CalculatorInput label="Marketing Spend" value={inputs.marketingSpend} onChange={(v)=>setInputs({...inputs, marketingSpend: v})} unit="$" />
                              <div className="grid grid-cols-2 gap-2">
                                <CalculatorInput label="New Custs" value={inputs.newCustomers} onChange={(v)=>setInputs({...inputs, newCustomers: v})} />
                                <CalculatorInput label="Churned" value={inputs.churnedCustomers} onChange={(v)=>setInputs({...inputs, churnedCustomers: v})} />
                              </div>
                              <CalculatorInput label="Total Custs" value={inputs.totalCustomers} onChange={(v)=>setInputs({...inputs, totalCustomers: v})} />
                          </div>
                          <div className="md:col-span-8">
                              <h3 className="font-bold text-gray-700 text-sm border-b border-gray-200 pb-2 mb-4">2. Your Metrics</h3>
                              <div className="grid grid-cols-2 md:grid-cols-3 gap-3">
                                  <ResultBadge label="Gross Margin" value={metrics.gm.toFixed(1)} unit="%" {...getInsight('gm', metrics.gm)} />
                                  <ResultBadge label="CAC" value={metrics.cac.toFixed(0)} unit="$" status="neutral" />
                                  <ResultBadge label="LTV:CAC" value={metrics.ltvCac.toFixed(1)} unit="x" {...getInsight('ltvCac', metrics.ltvCac)} />
                                  <ResultBadge label="Payback" value={metrics.payback.toFixed(1)} unit="mo" {...getInsight('payback', metrics.payback)} />
                                  <ResultBadge label="Rule of 40" value={metrics.rule40.toFixed(1)} unit="pts" {...getInsight('rule40', metrics.rule40)} />
                              </div>
                          </div>
                      </div>
                  )}
                </div>
              )}

              {/* LAYER 2: BUSINESS MODEL */}
              {activeLayer === 2 && (
                <div className="bg-white rounded-xl shadow-sm border border-slate-100 p-5 animate-fade-in">
                  <div className="flex items-center gap-2 mb-4">
                    <span className="p-1.5 bg-blue-100 text-blue-600 rounded text-lg">üèóÔ∏è</span>
                    <h2 className="font-bold text-gray-800">Business Model Specifics</h2>
                  </div>
                  
                  <div className="bg-slate-50 rounded-lg p-4 mb-4 border border-slate-200">
                    <SelectionGroup title="1. Go-to-Market Model" options={gtmOptions} selected={selectedGTM} onSelect={setSelectedGTM} />
                    <SelectionGroup title="2. Growth Strategy" options={growthOptions} selected={selectedGrowth} onSelect={setSelectedGrowth} />
                    <SelectionGroup title="3. Pricing Model" options={pricingOptions} selected={selectedPricing} onSelect={setSelectedPricing} />
                    <SelectionGroup title="4. Market Focus" options={marketOptions} selected={selectedMarket} onSelect={setSelectedMarket} />
                  </div>

                  {layer2Metrics.length > 0 ? (
                    <div>
                      <h3 className="text-xs font-bold text-gray-400 uppercase mb-2">Recommended Metrics</h3>
                      <div className="space-y-2 max-h-80 overflow-y-auto pr-2">
                        {layer2Metrics.map((m, i) => (
                          <div key={i} className="flex items-center justify-between bg-white border border-gray-100 rounded-lg px-3 py-2 shadow-sm">
                            <div className="flex items-center gap-2">
                              <span className={`text-[10px] px-2 py-0.5 rounded-full uppercase font-bold ${catColors[m.cat]}`}>{m.cat}</span>
                              <span className="font-medium text-gray-800 text-sm">{m.name}</span>
                            </div>
                            <span className="text-xs text-gray-500">{m.desc}</span>
                          </div>
                        ))}
                      </div>
                    </div>
                  ) : (
                    <div className="text-center py-8 text-gray-400 bg-slate-50 rounded-lg border border-dashed border-slate-300">
                      <p>üëÜ Select options above to generate metrics</p>
                    </div>
                  )}
                </div>
              )}

              {/* PLACEHOLDER FOR LAYERS 3 & 4 (To keep code short, you can re-enable full content if needed) */}
              {(activeLayer === 3 || activeLayer === 4) && (
                  <div className="bg-white rounded-xl p-10 text-center border border-slate-100">
                      <p className="text-gray-400">Layer {activeLayer} content hidden for brevity in this update.</p>
                  </div>
              )}

              {/* FOOTER */}
              <div className="mt-6 border-t border-slate-200 pt-4 px-2">
                 <div className="flex items-center gap-2 mb-2">
                    <span className="text-lg">üìö</span>
                    <h3 className="text-sm font-bold text-slate-700">T√†i li·ªáu tham kh·∫£o cho Layer {activeLayer}</h3>
                 </div>
                 <div className="flex flex-wrap gap-2">
                    {layerReferences[activeLayer] && layerReferences[activeLayer].map((ref, idx) => (
                      <a key={idx} href={ref.url} target="_blank" rel="noopener noreferrer" 
                          className="inline-flex items-center gap-1.5 px-3 py-1.5 bg-white border border-slate-200 rounded-lg text-xs font-medium text-blue-600 hover:text-blue-800 hover:border-blue-300 hover:bg-blue-50 transition-all no-underline group shadow-sm">
                          <span>{ref.title}</span>
                      </a>
                    ))}
                 </div>
              </div>

            </div>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('unified-metrics-root'));
      root.render(<UnifiedMetricsFramework />);
    </script>
</body>
</html>